{% extends "base_entite.html.twig" %}
{% block page_content %}
    {% set action = "add" %}
    <div class="content-detail">
    <div class="row rowHeader">
    	<div class="slider">
    		{% if entite.id == "56a750a01efa456c7c7c5c2c" %}
	        <div class="slide">
	        	<img src="/web/images/lafayette_large.jpg" />
	        </div>
	        {% endif %}
	        <div class="slide">
    			<img src="https://maps.googleapis.com/maps/api/staticmap?markers={{ entite.lat }},{{ entite.lng }}&zoom=15&size=640x200&key=AIzaSyDB9Yn2WgZHDESQdomUfpHQK3WpU5Zj2FQ" />
    		</div>
    	</div>
    </div>
    
    <div class="row rowInfos">
        <div class="avatar">
            <div>
            	<img src="{{ apiImagePath(entite.logo) }}" alt="..." style="background: white;"/>
            </div>
        </div>
        <div class="col-xs-12">
        	<div class="row">
	        	<div class="col-xs-7">
		            <h1>{{ entite.name }} <a href="#certifs" class="fa fa-certificate"><span>{{ certifs|length }}</span></a></h1>
	    	        <p>
	        	        <a style="color: #ffffff"
	            	       href="{{ path_for("map.homepage") }}?center={{ entite.lat }},{{ entite.lng }}">{{ entite.adresseComplete }}</a>
	            	</p>
	            	<p>
	                	
	            	</p>
	            </div>
	            <div class="col-xs-5 right">
	            	{% if entite.activite == "RESTAURATION_COLLECTIVE" %}
	            	<a href="#menu-jour" class="button button-green"><i class="fa fa-calendar-o" aria-hidden="true"></i><span>Voir Menu</span></a>
	            	{% endif %}
	            	<a href="#blog" class="button button-green"><i class="fa fa-newspaper-o" aria-hidden="true"></i></a>
	            </div>
	        </div>
            {% block lien_fournisseurs %}
            {% endblock %}
        </div>
    </div>
    <div class="row rowActions IconAction">
        <div class="col-xs-12">
            <ul>
                {% if entite.telephoneContact or 1 %}
                <li>
                    <a class="" href="tel:{{ entite.telephoneContact }},">
                        <i class="fa fa-phone" aria-hidden="true"></i>
                        <span>Appeler</span>
                    </a>
                </li>
                {% endif %}
                <li>
                    {% set text = "Ajouter" %}
                    {% set icon = "fa-heart" %}
                    {% if isFavorite(entite.id) %}
                        {% set action = "delete" %}
                        {% set text = "Supprimer" %}
                    {% endif %}
                    <a href="{{ path_for("app.change.favorite",{"idEntite":entite.id,"action":action}) }}">
                         <i class="fa {{icon}}" aria-hidden="true"></i>
                         <span>{{text}}</span>
                    </a>
                </li>
                {% if entite.siteWeb or 1 %}
                <li>
                    <a href="{{entite.siteWeb}}" target="_blank">
                        <i class="fa fa-globe" aria-hidden="true"></i>
                        <span>Site Web</span>
                    </a>
                </li>
                {% endif %}
                {% if entite.activite == "RESTAURATION_COLLECTIVE" %}
                <li>
                    <a href="#menu-jour">
                        <i class="fa fa-calendar-check-o" aria-hidden="true"></i>
                        <span>REMPLIR PRESENCE</span>
                    </a>
                </li>
                {% endif %}
            </ul>
            {% if entite.hasVenteDirecte %}
                {% block venteDirecte %}
                    <div class="col-xs-8">
                        <a style="padding-top: 12px" class="btn btn-vert" id="Reserver" type="submit"
                           href="{{ path_for("app.entite.produits",{"id":entite.id}) }}">
                            Vente Directe
                        </a>
                    </div>
                {% endblock %}
            {% endif %}
        </div>
    </div>
    <div class="row rowDescription">
        <div class="col-xs-12" id="Description">
            <p>
                {{ entite.description|raw }}
            </p>
        </div>
    </div>

    {% block menu %}{% endblock %}

    {% block certifs %}
        {% if certifs|length >0 %}
            <div id="certifs" class="row">
                    <div class="row rowBar">
                    <div class="icon">
		            	<i class="fa fa-certificate" aria-hidden="true"></i>
		            </div>
		            <div class="text">
		            	<b>Label qualité</b>
		            	<span>{{ certifs|length }} label{{ certifs|length > 1 ? 's' : ''}}</span>
		            </div>
                </div>
                <div class="row rowList rowListCertifs">
                    {% for certif in certifs %}
                        {% if certif.entiteId %}
                            {% set link=path_for("app.entite.detail",{"id":certif.entiteId}) %}
                        {% else %}
                            {% set link="" %}
                        {% endif %}
                        <div class="col-xs-6">
                            <div class="col-xs-4 colImg">
                                <a href="{{ link }}"><img src="{{ apiImagePath(certif.logo) }}" class="img-responsive"></a>
                            </div>
                           <div class="col-xs-8 infos">
                           		<p class="Intitule">depuis le 18/02/1965</p>
                           		<h3 class=""><a href="{{ link }}">{{ certif.nom }}</a></h3>
                           		<a href="">Télécharger le certificat</a>
                           		<a href="{{ link }}">En savoir plus</a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    {% endblock %}

    {% block membres %}
        {% if entite.activite == "FILIERE" and membres|length>0 %}
            <div class="row">
                <div class="col-xs-12">
                    <h3 style="text-align:center;padding:20px 0">Ils en font partie</h3>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12 col-sm-6">
                    <div id="map" style="height: 500px;margin-top: 0px;background: #FFF;"></div>
                </div>
                <div class="col-xs-12 col-sm-6">

                    {% set titles = {
                    "BOUCHER":"Bouchers",
                    "RESTAURANT":"Restaurants",
                    "RESTAURATION_COLLECTIVE":"Restauration collective",
                    "ELEVEUR":"Eleveurs",
                    "ABATTOIR":"Abattoirs",
                    "GROSSISTE": "Grossistes",
                    "NEGOCIANT":"Négociants",
                    "ASSOCIATION":"Associations",
                    "DISTRIBUTEUR":"Distributeurs"
                    } %}

                    {% for activite,title in titles %}
                        {% include "Block/membres.html.twig" %}
                    {% endfor %}
                </div>
            </div>
        {% endif %}
    {% endblock %}

    {% block blog %}
        {% if blog|length >0 %}
           <div id="blog" class="row rowBar">
                <div class="icon">
	            	<i class="fa  fa-newspaper-o" aria-hidden="true"></i>
	            </div>
	            <div class="text">
	            	<b>Blog et actualités</b>
	            	<span>{{ blog|length }} actualité{{ blog|length > 1 ? 's' : ''}}</span>
	            </div>
            </div>
            <div class="row rowList">
                {% for billet in blog %}
                   <div class="post">
                        <p class="date">le {{ (billet.publication/1000)|round(0)|date("d/m/Y H:i") }}</p>
                        {% if billet.type == "evenement" %}
                            <p class="titre">{{ billet.titre }}</p>
                            <p class="date hidden">Du {{ (billet.debut/1000)|round(0)|date("d/m/Y H:i") }} au {{ (billet.fin/1000)|round(0)|date("d/m/Y H:i") }}</p>
                        {% endif %}
                        <div class="content">{{ billet.contenu|raw }}</div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endblock %}

    {% block presse %}
        {% if presse|length >0 %}
            <div class="row Entete">
                <div class="col-xs-6 col-xs-offset-3 col-sm-4 col-sm-offset-4 text-center">
                    <img src="/web/images/news.svg" alt="" class="img-responsive" style="max-width: 20%;display: inline-block;">
                    <h3 class="text-center" style="display: inline-block">La presse</h3>
                </div>
            </div>
            <div class="row">
                {% for billet in presse %}
                    <div class="col-xs-10 col-xs-offset-1 ListeStyle3">
                        <div class="post">
                            <!--<p class="titre">{{ billet.titre }}</p>-->
                            <p class="date">{{ (billet.publication/1000)|round(0)|date("d/m/Y H:i") }}</p>
                            <p class="texte">{{ billet.contenu|raw }}</p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endblock %}
    </div>
{% endblock %}

{% block afterMapInit %}
    var bounds = new google.maps.LatLngBounds();
    {% for entite in membres %}
        {{ createMarker(entite) }}
        bounds.extend(marker{{ entite.id }}.getPosition())
    {% endfor %}
    map.fitBounds(bounds);

{% endblock %}

{% block javascripts %}
{{ parent() }}
<script type="text/javascript">
$('.slider').slick({slide:'.slide', arrows: false}) ;
</script>
{% endblock %}